# 恒星間距離シミュレーター仕様書

## 1. 概要

### 1.1 プログラム名
**恒星間距離体感マップ**

### 1.2 目的
主な恒星間の距離を地図上に縮尺して表示し、恒星間の膨大な距離感を視覚的に理解できるようにする。太陽を起点として、近傍の恒星までの距離を地球上の実際の距離に置き換えて表示する。

### 1.3 ベースとなるプログラム
`solar-system-map.html`（太陽系大きさ体感マップ）の構造とUIを踏襲

---

## 2. 機能要件

### 2.1 コア機能

#### 2.1.1 縮尺設定機能
- **入力方式**: 光年単位での距離を地図上の距離(km)に変換
- **入力項目**:
  - 「1光年を何kmで表示するか」を入力
  - 例: 1光年 = 100km と設定した場合、4.24光年のプロキシマ・ケンタウリは424km先に表示
- **自動計算**: 入力値から全恒星の地図上での距離を自動計算

#### 2.1.2 恒星データ表示機能
以下の日本から観測可能な星座を構成する主要な恒星を表示対象とする:

| 恒星名           | 距離(光年) | 実際の直径(太陽比) | 色      | 所属星座          |
| ---------------- | ---------- | ------------------ | ------- | ----------------- |
| 太陽             | 0          | 1.0                | #FFD700 | 起点              |
| シリウス         | 8.60       | 1.71               | #87CEEB | おおいぬ座α星     |
| カノープス       | 310        | 65                 | #FFF8DC | りゅうこつ座α星   |
| アークトゥルス   | 36.66      | 25.4               | #FF8C00 | うしかい座α星     |
| ベガ             | 25.04      | 2.36               | #E0FFFF | こと座α星         |
| カペラ           | 42.92      | 12.2               | #FFFFE0 | ぎょしゃ座α星     |
| リゲル           | 860        | 78.9               | #B0E2FF | オリオン座β星     |
| プロキオン       | 11.46      | 1.42               | #FFFACD | こいぬ座α星       |
| ベテルギウス     | 548        | 764                | #FF4500 | オリオン座α星     |
| アルタイル       | 16.73      | 1.63               | #F0F8FF | わし座α星         |
| アルデバラン     | 65.23      | 44.2               | #FF6347 | おうし座α星       |
| アンタレス       | 550        | 883                | #DC143C | さそり座α星       |
| スピカ           | 250        | 7.4                | #B8E0F0 | おとめ座α星       |
| ポルックス       | 33.78      | 8.8                | #FFB6C1 | ふたご座β星       |
| フォーマルハウト | 25.13      | 1.84               | #FFF0F5 | みなみのうお座α星 |
| デネブ           | 2600       | 203                | #F0F8FF | はくちょう座α星   |
| レグルス         | 79.3       | 3.9                | #E8F0FF | しし座α星         |
| カストル         | 51.6       | 1.7                | #F5F8FF | ふたご座α星       |
| ミラク           | 197        | 14.0               | #FFD700 | アンドロメダ座β星 |
| アルニラム       | 2000       | 42.0               | #B8D8FF | オリオン座ε星     |
| アルニタク       | 1260       | 20.0               | #C0D8FF | オリオン座ζ星     |
| ミンタカ         | 1200       | 16.5               | #C0E0FF | オリオン座δ星     |
| ベラトリックス   | 243        | 5.8                | #F0F8FF | オリオン座γ星     |
| サイフ           | 650        | 14.0               | #B8D8FF | オリオン座κ星     |
| ポラリス(北極星) | 433        | 37.5               | #FFFACD | こぐま座α星       |
| デネボラ         | 36         | 1.7                | #F5F8FF | しし座β星         |
| ミザール         | 82.9       | 2.4                | #F8F8FF | おおぐま座ζ星     |
| アルフェラッツ   | 97         | 2.7                | #E8F0FF | アンドロメダ座α星 |
| ツバーン         | 303        | 40.0               | #FFFACD | りゅう座α星       |

#### 2.1.3 地図表示機能
- **ベース地図**: 
  - OpenStreetMap (デフォルト)
  - 地理院地図(標準/淡色/白地図/衛星写真)
- **起点マーカー**: 
  - 太陽の位置をドラッグ可能なマーカーで表示
  - 初期位置: 任意の地点(例: 東京駅、緯度35.6812, 経度139.7671)
- **恒星表示**:
  - 各恒星を円形のマーカーで表示
  - マーカーサイズは恒星の実際の大きさを反映(オプション)
  - 線で太陽と恒星を結ぶ
  - 恒星名ラベルを表示

#### 2.1.4 距離線表示機能
- 太陽から各恒星への直線を描画
- 線の太さ: 恒星の明るさや重要度に応じて調整
- 線の種類:
  - 実線: 主要な恒星
  - 破線: 連星系の副星
  - 点線: 参考恒星

### 2.2 情報表示機能

#### 2.2.1 ポップアップ表示
恒星または距離線をクリックすると以下の情報を表示:
- 恒星名
- 太陽からの実際の距離(光年)
- 地図上での距離(km)
- 恒星の種類(主系列星、赤色矮星、白色矮星など)
- 恒星の直径(太陽比)
- 表面温度
- 到達時間の計算:
  - 光速での到達時間
  - 現在の宇宙船の速度での到達時間(例: ボイジャー1号の速度)
  - 仮想的な高速宇宙船での到達時間(光速の1%, 10%など)
- Google Mapsでその地点を表示するリンク

#### 2.2.2 凡例パネル
- 表示中の恒星リスト
- 色と恒星名、距離の対応表
- 折りたたみ可能

#### 2.2.3 描画範囲外パネル
- 地図の表示範囲を超える恒星のリスト
- 実際の距離と地図上での距離を表示
- 日本列島の長さ(約3000km)を基準とした比較表示

### 2.3 操作機能

#### 2.3.1 コントロールパネル
以下の項目を含む:
- 背景地図選択ドロップダウン
- 縮尺設定入力フィールド:
  - 「1光年 = __ km」
  - 推奨値の例: 50km, 100km, 500km, 1000km
- プリセットボタン:
  - 「近傍恒星モード」(1光年=100km): 10光年以内を表示
  - 「中距離モード」(1光年=10km): 50光年程度まで表示
  - 「広域モード」(1光年=1km): 数百光年まで表示
- 恒星サイズ表示ON/OFF切り替え
- 「描画更新」ボタン
- パネルの折りたたみ機能

#### 2.3.2 太陽マーカーのドラッグ
- 太陽の位置をドラッグで変更可能
- ドラッグ終了時に自動的に恒星の位置を再計算

#### 2.3.3 全画面モード
- 全画面表示/解除ボタン
- Escキーで全画面解除

---

## 3. 技術仕様

### 3.1 使用技術
- **HTML5**: ページ構造
- **CSS3**: スタイリングとレスポンシブデザイン
- **JavaScript (ES6+)**: ロジック実装
- **MapLibre GL JS v5.0.0**: 地図表示ライブラリ
- **Turf.js v6.5.0**: 地理空間計算ライブラリ

### 3.2 主要な計算式

#### 3.2.1 地図上の距離計算
```
地図上の距離(km) = 実際の距離(光年) × 縮尺係数(km/光年)
```

#### 3.2.2 恒星の位置計算
- 太陽の座標を中心とする
- 各恒星を方位角を適切に配置(実際の方位または均等配置)
- Turf.jsの`destination`関数を使用

#### 3.2.3 到達時間の計算
```javascript
// 光速での時間
光速 = 299,792 km/s
距離(km) = 光年 × 9.461e+12 km
時間(秒) = 距離(km) / 光速

// ボイジャー1号の速度での時間
ボイジャー速度 = 17 km/s
時間(年) = 距離(km) / ボイジャー速度 / 31,536,000
```

### 3.3 データ構造

#### 恒星オブジェクト
```javascript
{
  name: '恒星名',
  distanceLY: 光年での距離,
  diameterSolar: 太陽を1とした直径比,
  color: '#RRGGBB',
  type: '恒星の種類',
  azimuth: 方位角(度), // 太陽から見た方向
  temperature: 表面温度(K),
  spectralClass: 'スペクトル型',
  hasExoplanets: true/false // 系外惑星の有無
}
```

### 3.4 地図レイヤー構成
1. ベース地図レイヤー
2. 距離線レイヤー(太陽から各恒星への線)
3. 恒星マーカーレイヤー
4. 恒星名ラベルレイヤー
5. 太陽マーカーレイヤー(最前面)

---

## 4. UI/UX仕様

### 4.1 レイアウト
- 左上: コントロールパネル(折りたたみ可能)
- 右上: 描画範囲外パネル(折りたたみ可能)
- 右下: 凡例パネル(折りたたみ可能)
- 左下: 全画面モードボタン
- 中央: 地図エリア

### 4.2 カラースキーム
- 恒星の色は実際のスペクトル型に基づく
- 距離線の透明度: 0.6
- パネル背景: 白(rgba(255, 255, 255, 0.95))
- パネルシャドウ: 0 2px 10px rgba(0,0,0,0.2)

### 4.3 レスポンシブデザイン
- モバイル対応
- パネルは小画面では最小化された状態で表示
- タッチ操作対応

---

## 5. パフォーマンス要件

### 5.1 描画パフォーマンス
- 恒星数30個程度でスムーズに動作
- 描画更新は1秒以内に完了

### 5.2 メモリ使用量
- ブラウザのメモリ使用量を抑制
- 不要なレイヤーは適切に削除

---

## 6. 拡張機能(オプション)

### 6.1 アニメーション機能
- 光が太陽から恒星まで進むアニメーション
- 宇宙船が移動するアニメーション

### 6.2 比較機能
- 複数の縮尺を同時に表示
- 分割画面で異なる縮尺を比較

### 6.3 フィルター機能
- 恒星の種類でフィルター(主系列星のみ、巨星のみなど)
- 距離範囲でフィルター(10光年以内など)
- 系外惑星を持つ恒星のみ表示

### 6.4 統計情報
- 表示中の恒星数
- 平均距離
- 最遠の恒星

### 6.5 共有機能
- 現在の表示状態をURLで共有
- スクリーンショット機能

---

## 7. アクセシビリティ

### 7.1 キーボード操作
- Tabキーでフォーカス移動
- Enterキーで描画更新
- Escキーで全画面解除

### 7.2 スクリーンリーダー対応
- 適切なARIAラベルの設定
- セマンティックHTML要素の使用

---

## 8. ブラウザ対応

### 8.1 対応ブラウザ
- Google Chrome (最新版)
- Mozilla Firefox (最新版)
- Microsoft Edge (最新版)
- Safari (最新版)

### 8.2 必要な機能
- JavaScript有効
- WebGL対応
- Geolocation API(オプション)

---

## 9. 開発スケジュール(目安)

1. **フェーズ1**: 基本機能実装(2-3日)
   - 地図表示
   - 縮尺計算
   - 恒星データ表示
   - 基本UI

2. **フェーズ2**: 情報表示機能(1-2日)
   - ポップアップ
   - 凡例
   - 到達時間計算

3. **フェーズ3**: UI改善(1日)
   - 折りたたみ機能
   - 全画面モード
   - レスポンシブ対応

4. **フェーズ4**: テストと調整(1日)
   - 動作確認
   - パフォーマンス最適化
   - バグ修正

---

## 10. 参考資料

### 10.1 恒星データの出典
- SIMBAD Astronomical Database
- Hipparcos Catalogue
- Gaia DR3

### 10.2 技術ドキュメント
- MapLibre GL JS API: https://maplibre.org/maplibre-gl-js-docs/api/
- Turf.js Documentation: https://turfjs.org/
- 地理院地図API: https://maps.gsi.go.jp/development/ichiran.html

---

## 11. ファイル構成

```
stellar-distance-map.html    # メインHTMLファイル(1ファイル構成)
恒星間距離シミュレーター仕様書.md  # 本仕様書
README.md                     # プロジェクト説明
```

---

## 12. メタデータ

### 12.1 SEO対策
- **タイトル**: 恒星間距離体感マップ
- **ディスクリプション**: 主な恒星間の距離を地図上に縮尺表示し、宇宙の広大さを体感できるインタラクティブマップ
- **キーワード**: 恒星間距離, 光年, 宇宙, 天文学, インタラクティブマップ, 恒星, プロキシマ・ケンタウリ, シリウス, ベガ

### 12.2 OGP設定
- og:title: 恒星間距離体感マップ
- og:description: 主な恒星間の距離を地図上に縮尺表示
- og:type: website

---

## 13. 注意事項

### 13.1 科学的正確性
- 恒星データは最新の天文学データベースを参照
- 距離は地球から見た値(太陽中心ではない場合は注記)
- 恒星の方位角は実際の赤経・赤緯に基づく

### 13.2 表示制限
- 地図の表示範囲を超える恒星は「範囲外パネル」に表示
- 極端な縮尺では一部の恒星が重なる可能性がある

### 13.3 パフォーマンス
- 30個を超える恒星を表示する場合は段階的な読み込みを検討
- モバイル端末では初期表示恒星数を制限

---

## 14. 更新履歴

- 2025/12/10: 初版作成
